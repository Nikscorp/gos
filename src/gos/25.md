# 25. Дискретные цепи Маркова. Метод вложенных цепей Маркова при исследовании систем массового обслуживания.

Пусть $X_1, X_2,...,X_n,..$ - последовательность случайных величин, принимающих значения  $1,..,k,..$  (счетное множество). Процесc $X_t$  будет марковской цепью при условии того, что следующее значение в цепи зависит только от предыдущего: $P(X_{n+1} = i_{n+1} | X_n=i_n, ..., X_1 = i_1) = P(X_{n+1} = i_{n+1} | X_n =i_n)$ 

Важным параметром характеристики цепи Маркова является вероятность перехода за один шаг $P_{i_nj_{n+1},n}$, и если она не зависит от $n$, то **цепь Маркова называется однородной** . Далее рассматриваются только такие цепи.

Пусть вероятность перехода из состояния $i$ в состояние $j$ : $P(X_{n+1} = j| X_n = i) = P_{ij}$. Тогда матрица вероятностей перехода за один шаг обозначается $(P_{ij})$ - матрица вероятностей перехода за один шаг.

Вероятность перехода за из состояние $i$ в состояние $j$ за $n$ шагов обозначается следующим образом$P(X_{k+n}=j| X_k = i) = P_{ij}^{(n)}$ . 

$P_i^0 = P(X_1=i)$ - задает начальное распределение вероятностей.

Для определения вероятности перехода за любое число шагов используется уравнение **Колмогорова-Чепмена**:  $P_{ij}^{n+m} = \sum\limits_{k=1}^{\infin} P_{ik}^{(n)} P_{k,j}^{(m)}$ .



**Некоторые свойства цепей Маркова**:

**Достижимость состояния** - состояние $j$ достижимо из $i$  $\Leftrightarrow$ $\exists n : P_{ij}^{(n)} \gt 0$

**Несущественность состояния** - состояние $i$ называется несущественным, если $\exists j :$ $j$ из $i$ достижимо, но $i$ из $j$ недостижимо

**Поглощающее состояние** - состояние $i$ называется поглощающим, если $P_{ii} = 1$

Далее будем рассматривать цепи Маркова без несущественных состояний и без поглощающих состояний

**Сообщающиеся состояния** - $i$ и $j$, сообщающиеся $i \leftrightarrow j$, если $i$ достижимо из $j$ и наоборот

**Неразложимость цепи** - цепь Маркова неразложима, если все состояния образуют один класс сообщающихся состояний

**Период состояния $i$** : $d(i) = НОД(n : P_{ii}^{(n)} \gt 0, n \ge 1) $

**Непериодическое состояние** - $d(i) = 1$

**Утверждение**: если $i \leftrightarrow j$, то $d(i) = d(j)$. Таким образом для неразложимой цепи можно говорить о периоде цепи Маркова

**Вероятность первого возвращения за $n$ шагов** $f_{ii}^{(n)} = P(X_n=i, X_{n-1} \neq i, …, X_{1} \neq i | X_0 = i)$

**Вероятность возвращения за конечное число шагов** $f_{ii} = \sum\limits_{n=1}^{\infin}f_{ii}^{(n)}$

**Возвратность состояния** - состояние $i$ возвратна, если $f_{ii} = 1$

**Утверждение**: если $i $ возвратно и $i \leftrightarrow j$, то $j$ возвратно. Таким образом для неразложимой цепи можно говорить о возвратности цепи

Цепь Маркова называется эргодической, если $\pi_j = \lim\limits_{n \to \infin}P_{ij}^{(n)}$. 

**Теорема**. Рассмотрим неразложимую, непериодическую возвратную цепь Маркова. Тогда $\exists \lim\limits_{n \to \infin} P_{ii}^{(n)} = {1 \over \sum\limits_{n=1}^{\infin}nf_{ii}^{(n)}}$ , и $\lim\limits_{n \to \infin} P_{ji}^{(n)} = \lim\limits_{n \to \infin} P_{ii}^{(n)}$ 

Важным понятием является **стационарное распределение** цепи Маркова $\pi = (\pi_0, \pi_2, \dots), \pi_k \ge 0, k \ge 0, \sum\limits_{k \ge 0} \pi_k = 1$, которое удовлетворяет соотношениям $\pi_j = \sum\limits_{k}\pi_kP_{kj}$

**Теорема**. Существует и единственно стационарное распределение при условии неразложимости, непериодичности и возвратности цепи Маркова.



**Система массового обслуживания**

В случайные моменты времени в системе появляются запросы на обслуживание. Система массового обслуживания  имеет приборы для обслуживания заявок и дисциплины обслуживания принятых заявок.

**Входящий поток** это $\{z_i\}, i \ge 1$ -  последовательность неотрицательных случайных величин, задающая последовательность интервалов между поступлениями заявок на обслуживание

Если $z_1,z_2,...$  - независимые одинаково распределенные случайные величины, то такой поток называется **реккурентным** и $P(z_1,...,z_n) = P(z_1)...p(z_n) = P(z)^n = A(x)$.

**Пуассоновский поток** - поток, где $A(x) = 1-e^{-ax}$

**Интенсивность потока** $a$ - среднее число заявок в единицу времени



**Метод вложенных цепей**

$L(t)$ - число заявок в системе в момент времени $t$. Если не все потоки поступления и обработки заявок имеют  показательное распределение (а значит процесс не марковский в общем), то стоит рассматривать систему только в те  моменты времени, когда процесс будет марковским. Например  d моменты завершения обработки заявки (если время обработки не показательное) и рассматривать $L_n=L(t_n +0)$ - в момент завершения $n$-го кванта времени.

Далее методами теории цепей Маркова исследуют стационарное распределение вложенной цепи и затем по этому распределению восстанавливают стационарное распределение исходного процесса.


